{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Shop" %} | Art Leptis{% endblock %}

{% block content %}
<section class="bg-paper py-12 md:py-16 lg:py-20">
  <div class="mx-auto max-w-7xl px-6 md:px-12 lg:px-16">

    {# ── HEADER ── #}
    <div class="reveal-up">
      <div class="flex items-end justify-between gap-6">
      <div>
        <h1 class="headline-serif text-4xl md:text-5xl">
        {% trans "Shop" %}
        </h1>
        <p class="mt-2 text-ink-60 text-base max-w-md">
        {% trans "Explore our curated collection of handmade objects." %}
        </p>
      </div>

      {# Search icon — opens search modal #}
      <button
        type="button"
        x-data
        @click="$dispatch('open-search')"
        class="header-icon-btn mb-1 shrink-0"
        aria-label="{% trans 'Search products' %}"
      >
        <svg
        class="w-5 h-5"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        viewBox="0 0 24 24"
        >
        <circle cx="11" cy="11" r="8" />
        <path d="m21 21-4.35-4.35" />
        </svg>
      </button>
      </div>

      <div class="rule mt-8"></div>
    </div>

    {# ── FILTERS + COUNT ── #}
    <div class="mt-6 flex flex-col gap-4 sm:flex-row sm:items-center
                sm:justify-between reveal-up">
      <nav
        class="flex flex-wrap gap-2"
        aria-label="{% trans 'Product filters' %}"
      >
        <a
          href="{% url 'products:product_list' %}"
          class="pill {% if not active_category %}pill--active{% endif %}"
        >
          {% trans "All" %}
        </a>
        {% for c in categories %}
          <a
            href="{% url 'products:product_list' %}?category={{ c.slug }}"
            class="pill
              {% if active_category == c.slug %}pill--active{% endif %}"
          >
            {{ c.name }}
          </a>
        {% endfor %}
      </nav>

      {% if page_obj %}
        <span class="text-meta shrink-0">
          {{ page_obj.paginator.count }}
          {% if page_obj.paginator.count == 1 %}
            {% trans "product" %}
          {% else %}
            {% trans "products" %}
          {% endif %}
        </span>
      {% endif %}

    </div>

    {# ── PRODUCT LIST (GRID + PAGINATION) ── #}
    {% include "products/_list_fragment.html" %}

  </div>
</section>
{% endblock %}
